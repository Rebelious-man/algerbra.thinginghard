# install
sudo apt update
sudo apt install wireguard

# generate keys (on server)
umask 077
wg genkey | tee server_private.key | wg pubkey > server_public.key

# generate client keys (locally or server)
wg genkey | tee client_private.key | wg pubkey > client_public.key

# create config /etc/wireguard/wg0.conf (example)
sudo tee /etc/wireguard/wg0.conf > /dev/null <<'EOF'
[Interface]
Address = 10.0.0.1/24
ListenPort = 51820
PrivateKey = <server_private_key>

# Client example
[Peer]
PublicKey = <client_public_key>
AllowedIPs = 10.0.0.2/32
EOF

# enable and start
sudo systemctl enable wg-quick@wg0
sudo systemctl start wg-quick@wg0

# enable IP forwarding
sudo sysctl -w net.ipv4.ip_forward=1
# make persistent in /etc/sysctl.conf: net.ipv4.ip_forward=1

# set up NAT (replace eth0 if different)
sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
[Interface]
PrivateKey = <client_private_key>
Address = 10.0.0.2/32
DNS = 1.1.1.1

[Peer]
PublicKey = <server_public_key>
Endpoint = your.server.ip.address:51820
AllowedIPs = 0.0.0.0/0

